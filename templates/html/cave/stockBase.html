

{% block containerStock %}

    <script>

    $(document).on("click", ".boutonAddBouteille", function (e) {

	e.preventDefault();

	var _self = $(this);

	var bouteilleId = _self.data('id');
	var bouteilleName = _self.data('name');
	var bouteilleAnnee = _self.data('annee');
	$("#id_idBouteille").val(bouteilleId);
	$("#myModalLabel").html(bouteilleName +"("+ bouteilleAnnee+")");

	$(_self.attr('href')).modal('show');
});
    /* appel ajax pour ajouter nb bouteille dans le stock de l'utilisateur
    Ceci appel al focntion rapide d'ajout, qui prend les vaeurs par defaut
    */
    function addToStockFromRef(idRef,nb){
    tab_bouteille = Array()
    tab_bouteille[0]={"idRef": idRef, "nb": nb};

    $.ajax({
        type: "POST",
        url: "/cave/addToStockFromRef",
        dataType: "json",
        traditional: true,
        data: {'list_bouteille': JSON.stringify(tab_bouteille)},
        success: function(data) {
            console.log(data["HTTPRESPONSE"]);
        }
});
    //href="/cave/addToStockFromRef/{{ x.id }}"
}
    </script>

    {% for x in listeBouteille %}
        <br/>
        <img src="{{ x.imageB.url }}" width="40px" height="40px">

        <span class="title ">{{ x.anneeB.nom }}-{{ x.nomB }}-{{ x.typeB }}</span> <br/>
        {% if user.is_authenticated %}


        <button class="btn btn-primary boutonAddBouteille" data-toggle="modal" data-target="#myModal" data-id="{{ x.id }}"
        data-name="{{ x.nomB }}" data-annee="{{ x.anneeB }}">
        Ajout cette bouteille Ã  mon stock
        </button>
        {% endif %}
    <br/>

    {% endfor %}
    <br/>

    <div class="pagination">
    <span class="step-links">
        <ul class="pager">

            {% if listeBouteille.has_previous %}
                <li class=""><a id="previousPage" href="#"
                                onclick="submit_ajax({{ listeBouteille.previous_page_number }})">&larr;
                    Previous</a>
                </li>


            {% else %}
                <li class=" disabled"><a> &larr; Previous</a></li>

            {% endif %}


            <span class="current">
            Page {{ listeBouteille.number }} of {{ listeBouteille.paginator.num_pages }}.
        </span>

            {% if listeBouteille.has_next %}
                <li class=""><a id="nextPage" href="#"
                                onclick="submit_ajax({{ listeBouteille.next_page_number }})">Next &rarr;</a></li>
            {% else %}
                <li class=" disabled"><a>Next &rarr;</a></li>

            {% endif %}

        </ul>
    </span>

    </div>



{% endblock %}

